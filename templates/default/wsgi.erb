"""
Generated by Chef for <%= node['fqdn'] %>.
Local modifications will be overwritten.
"""

import os
import sys
import site
<% if @config["sentry_dsn"] %>
try:
    from raven import Client
    from raven.middleware import Sentry
except ImportError:
    Client = Sentry = None
<% end %>

PROJECT_ROOT = os.path.normpath("<%= @config["home"] %>")

def rel(*parts):
    return os.path.join(PROJECT_ROOT, *parts)

sys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), "../")))

site.addsitedir(rel('<%= @config["env"] %>', 'lib', '<%= @config["python_version"] %>', 'site-packages'))
sys.path.append('<%= @config["home"] %>')
os.environ['DJANGO_SETTINGS_MODULE'] = 'current.settings'

import django.core.handlers.wsgi

application = django.core.handlers.wsgi.WSGIHandler()

<% if @config["sentry_dsn"] %>
if Client:
    # Low lever error handling
    application = Sentry(application, Client('<%= @config["sentry_dsn"] %>'))
<% end %>
